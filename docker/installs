#!/usr/bin/env sh

set -eu

# composer
curl -sS https://getcomposer.org/installer | php -- \
    --version=2.0.11 \
    --install-dir=/usr/local/bin \
    --filename=composer

# common and dev packages
apk add --no-cache \
    $PHPIZE_DEPS \
    git \
    openssh \
    vim

# pcov
mkdir -p /opt/php-libs  cd /opt/php-libs
git clone https://github.com/krakjoe/pcov.git /opt/php-libs/pcov
cd /opt/php-libs/pcov
phpize
./configure --enable-pcov
make
make install
docker-php-ext-enable pcov

# coveralls
wget https://github.com/php-coveralls/php-coveralls/releases/download/v2.4.3/php-coveralls.phar -O /usr/local/bin/coveralls
chmod +x /usr/local/bin/coveralls

# phpcs
composer global require squizlabs/php_codesniffer:dev-master

# infection
composer global require infection/infection