deptrac:
  ignore_uncovered_internal_classes: true # ignore dependency to internal php classes

  paths:
    - ./src
    - ./tests
    - ./../vendor/psr
  exclude_files: ~

  ruleset:
    HttpClientMessage: [ PSR-7-basic, PSR-17-basic ]
    ServiceResolver: [ PSR-11 ]
    TestHttpClientMessage: [ +HttpClientMessage, PhpUnit ]
    TestServiceResolver: [ +ServiceResolver, PhpUnit ]

  layers:
    - name: HttpClientMessage
      collectors:
      - { type: directory, value: ./src/http-message/public/ }
      - { type: directory, value: ./src/http-message/private/, private: true }

    - name: ServiceResolver
      collectors:
      - { type: directory, value: ./src/service-resolver/public/ }
      - { type: directory, value: ./src/service-resolver/private/, private: true }

    - name: TestServiceResolver
      collectors:
      - { type: directory, value: ./tests/ServiceResolver/ }
      - { type: classLike, value: Bauhaus\\Tests\\ServiceResolver\\Doubles\\NotFoundService }

    - name: PSR-7-basic
      collectors:
      - { type: classLike, value: Psr\\Http\\Message\\RequestInterface }
      - { type: classLike, value: Psr\\Http\\Message\\ResponseInterface }
      - { type: classLike, value: Psr\\Http\\Message\\StreamInterface }
      - { type: classLike, value: Psr\\Http\\Message\\UriInterface }

    - name: PSR-7-server
      collectors:
      - { type: classLike, value: Psr\\Http\\Message\\ServerRequestInterface }
      - { type: classLike, value: Psr\\Http\\Message\\UploadedFileInterface }

    - name: PSR-11
      collectors:
      - { type: directory, value: ../vendor/psr/container/ }

    - name: PSR-17-basic
      collectors:
      - { type: classLike, value: Psr\\Http\\Message\\RequestFactoryInterface }
      - { type: classLike, value: Psr\\Http\\Message\\ResponseFactoryInterface }
      - { type: classLike, value: Psr\\Http\\Message\\StreamFactoryInterface }
      - { type: classLike, value: Psr\\Http\\Message\\UriFactoryInterface }

    - name: PSR-17-server
      collectors:
      - { type: classLike, value: Psr\\Http\\Message\\ServerRequestFactoryInterface }
      - { type: classLike, value: Psr\\Http\\Message\\UploadedFileFactoryInterface }

    - name: PhpUnit
      collectors:
      - { type: classLike, value: PHPUnit\\Framework\\TestCase }

  formatters:
    graphviz:
      groups:
        Packages:
        - ServiceResolver
        Tests:
        - TestServiceResolver
        PSRs:
        - PSR-7-basic
        - PSR-7-server
        - PSR-11
        - PSR-17-basic
        - PSR-17-server
        Vendor:
        - PhpUnit
