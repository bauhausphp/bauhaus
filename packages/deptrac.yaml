deptrac:
  ignore_uncovered_internal_classes: true # ignore dependency to internal php classes

  paths:
    - ./src
    - ./tests
    - ./../vendor/psr
  exclude_files: ~

  ruleset:
    HttpMessage: [ PSR-7-17-basic ]
    ServiceResolver: [ PSR-11 ]
    TestHttpMessage: [ +HttpMessage, PhpUnit ]
    TestServiceResolver: [ +ServiceResolver, PhpUnit ]

  layers:
    - name: HttpMessage
      collectors:
      - { type: directory, value: ./src/http-message/public/ }
      - { type: directory, value: ./src/http-message/private/, private: true }

    - name: ServiceResolver
      collectors:
      - { type: directory, value: ./src/service-resolver/public/ }
      - { type: directory, value: ./src/service-resolver/private/, private: true }

    - name: TestHttpMessage
      collectors:
      - { type: directory, value: ./tests/Http/Message/ }

    - name: TestServiceResolver
      collectors:
      - { type: directory, value: ./tests/ServiceResolver/ }
      - { type: classLike, value: Bauhaus\\Tests\\ServiceResolver\\Doubles\\NotFoundService }

    - name: PSR-7-17-basic
      collectors:
      - { type: classLike, value: Psr\\Http\\Message\\MessageInterface }
      - { type: classLike, value: Psr\\Http\\Message\\RequestInterface }
      - { type: classLike, value: Psr\\Http\\Message\\ResponseInterface }
      - { type: classLike, value: Psr\\Http\\Message\\StreamInterface }
      - { type: classLike, value: Psr\\Http\\Message\\UriInterface }
      - { type: classLike, value: Psr\\Http\\Message\\RequestFactoryInterface }
      - { type: classLike, value: Psr\\Http\\Message\\ResponseFactoryInterface }
      - { type: classLike, value: Psr\\Http\\Message\\StreamFactoryInterface }
      - { type: classLike, value: Psr\\Http\\Message\\UriFactoryInterface }

    - name: PSR-11
      collectors:
      - { type: directory, value: ../vendor/psr/container/ }

    - name: PhpUnit
      collectors:
      - { type: classLike, value: PHPUnit\\Framework\\TestCase }

  formatters:
    graphviz:
      groups:
        Packages:
        - HttpMessage
        - ServiceResolver
        Tests:
        - TestHttpMessage
        - TestServiceResolver
        PSRs:
        - PSR-7-17-basic
        - PSR-11
        Vendor:
        - PhpUnit
